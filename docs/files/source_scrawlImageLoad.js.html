<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>source\scrawlImageLoad.js - scrawl-canvas</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../assets/css/logo.png" title="scrawl-canvas"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 4.2.0</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/Action.html">Action</a></li>
            
                <li><a href="../classes/Animation.html">Animation</a></li>
            
                <li><a href="../classes/Base.html">Base</a></li>
            
                <li><a href="../classes/Block.html">Block</a></li>
            
                <li><a href="../classes/BlurFilter.html">BlurFilter</a></li>
            
                <li><a href="../classes/BrightnessFilter.html">BrightnessFilter</a></li>
            
                <li><a href="../classes/Cell.html">Cell</a></li>
            
                <li><a href="../classes/ChannelsFilter.html">ChannelsFilter</a></li>
            
                <li><a href="../classes/ChannelStepFilter.html">ChannelStepFilter</a></li>
            
                <li><a href="../classes/Color.html">Color</a></li>
            
                <li><a href="../classes/Context.html">Context</a></li>
            
                <li><a href="../classes/Design.html">Design</a></li>
            
                <li><a href="../classes/Element.html">Element</a></li>
            
                <li><a href="../classes/ElementGroup.html">ElementGroup</a></li>
            
                <li><a href="../classes/Entity.html">Entity</a></li>
            
                <li><a href="../classes/Filter.html">Filter</a></li>
            
                <li><a href="../classes/Force.html">Force</a></li>
            
                <li><a href="../classes/Gradient.html">Gradient</a></li>
            
                <li><a href="../classes/GreyscaleFilter.html">GreyscaleFilter</a></li>
            
                <li><a href="../classes/Group.html">Group</a></li>
            
                <li><a href="../classes/Image.html">Image</a></li>
            
                <li><a href="../classes/InvertFilter.html">InvertFilter</a></li>
            
                <li><a href="../classes/LeachFilter.html">LeachFilter</a></li>
            
                <li><a href="../classes/Link.html">Link</a></li>
            
                <li><a href="../classes/MatrixFilter.html">MatrixFilter</a></li>
            
                <li><a href="../classes/NoiseFilter.html">NoiseFilter</a></li>
            
                <li><a href="../classes/Pad.html">Pad</a></li>
            
                <li><a href="../classes/PageElement.html">PageElement</a></li>
            
                <li><a href="../classes/Particle.html">Particle</a></li>
            
                <li><a href="../classes/Path.html">Path</a></li>
            
                <li><a href="../classes/Pattern.html">Pattern</a></li>
            
                <li><a href="../classes/Phrase.html">Phrase</a></li>
            
                <li><a href="../classes/Picture.html">Picture</a></li>
            
                <li><a href="../classes/PixelateFilter.html">PixelateFilter</a></li>
            
                <li><a href="../classes/Point.html">Point</a></li>
            
                <li><a href="../classes/Position.html">Position</a></li>
            
                <li><a href="../classes/Quaternion.html">Quaternion</a></li>
            
                <li><a href="../classes/RadialGradient.html">RadialGradient</a></li>
            
                <li><a href="../classes/SaturationFilter.html">SaturationFilter</a></li>
            
                <li><a href="../classes/Shape.html">Shape</a></li>
            
                <li><a href="../classes/Spring.html">Spring</a></li>
            
                <li><a href="../classes/SpriteAnimation.html">SpriteAnimation</a></li>
            
                <li><a href="../classes/Stack.html">Stack</a></li>
            
                <li><a href="../classes/StereoFilter.html">StereoFilter</a></li>
            
                <li><a href="../classes/Text.html">Text</a></li>
            
                <li><a href="../classes/ThresholdFilter.html">ThresholdFilter</a></li>
            
                <li><a href="../classes/Timeline.html">Timeline</a></li>
            
                <li><a href="../classes/TintFilter.html">TintFilter</a></li>
            
                <li><a href="../classes/Tween.html">Tween</a></li>
            
                <li><a href="../classes/Vector.html">Vector</a></li>
            
                <li><a href="../classes/Video.html">Video</a></li>
            
                <li><a href="../classes/Wheel.html">Wheel</a></li>
            
                <li><a href="../classes/window.scrawl.html">window.scrawl</a></li>
            
                <li><a href="../classes/window.scrawl_Animation.html">window.scrawl_Animation</a></li>
            
                <li><a href="../classes/window.scrawl_Block.html">window.scrawl_Block</a></li>
            
                <li><a href="../classes/window.scrawl_Collisions.html">window.scrawl_Collisions</a></li>
            
                <li><a href="../classes/window.scrawl_Color.html">window.scrawl_Color</a></li>
            
                <li><a href="../classes/window.scrawl_Factories.html">window.scrawl_Factories</a></li>
            
                <li><a href="../classes/window.scrawl_Filters.html">window.scrawl_Filters</a></li>
            
                <li><a href="../classes/window.scrawl_Images.html">window.scrawl_Images</a></li>
            
                <li><a href="../classes/window.scrawl_Path.html">window.scrawl_Path</a></li>
            
                <li><a href="../classes/window.scrawl_Phrase.html">window.scrawl_Phrase</a></li>
            
                <li><a href="../classes/window.scrawl_Physics.html">window.scrawl_Physics</a></li>
            
                <li><a href="../classes/window.scrawl_SaveLoad.html">window.scrawl_SaveLoad</a></li>
            
                <li><a href="../classes/window.scrawl_Shape.html">window.scrawl_Shape</a></li>
            
                <li><a href="../classes/window.scrawl_Stacks.html">window.scrawl_Stacks</a></li>
            
                <li><a href="../classes/window.scrawl_Wheel.html">window.scrawl_Wheel</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="../modules/scrawlAnimation.html">scrawlAnimation</a></li>
            
                <li><a href="../modules/scrawlBlock.html">scrawlBlock</a></li>
            
                <li><a href="../modules/scrawlCollisions.html">scrawlCollisions</a></li>
            
                <li><a href="../modules/scrawlColor.html">scrawlColor</a></li>
            
                <li><a href="../modules/scrawlCore.html">scrawlCore</a></li>
            
                <li><a href="../modules/scrawlFilters.html">scrawlFilters</a></li>
            
                <li><a href="../modules/scrawlImages.html">scrawlImages</a></li>
            
                <li><a href="../modules/scrawlPath.html">scrawlPath</a></li>
            
                <li><a href="../modules/scrawlPathFactories.html">scrawlPathFactories</a></li>
            
                <li><a href="../modules/scrawlPhrase.html">scrawlPhrase</a></li>
            
                <li><a href="../modules/scrawlPhysics.html">scrawlPhysics</a></li>
            
                <li><a href="../modules/scrawlSaveLoad.html">scrawlSaveLoad</a></li>
            
                <li><a href="../modules/scrawlShape.html">scrawlShape</a></li>
            
                <li><a href="../modules/scrawlStacks.html">scrawlStacks</a></li>
            
                <li><a href="../modules/scrawlWheel.html">scrawlWheel</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: source\scrawlImageLoad.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
//---------------------------------------------------------------------------------
// The MIT License (MIT)
//
// Permission is hereby granted, free of charge, to any person obtaining a copy
// of this software and associated documentation files (the &quot;Software&quot;), to deal
// in the Software without restriction, including without limitation the rights
// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
// copies of the Software, and to permit persons to whom the Software is
// furnished to do so, subject to the following conditions:
// 
// The above copyright notice and this permission notice shall be included in
// all copies or substantial portions of the Software.
// 
// THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
// THE SOFTWARE.
//---------------------------------------------------------------------------------


if (window.scrawl &amp;&amp; window.scrawl.modules &amp;&amp; !window.scrawl.contains(window.scrawl.modules, &#x27;imageload&#x27;)) {
	var scrawl = (function(my) {
		&#x27;use strict&#x27;;

		/**
# window.scrawl

scrawlImages module adaptions to the Scrawl library object

## New library sections

* scrawl.image - for Image objects
* scrawl.img - linking to copies of DOM &amp;lt;img&amp;gt; elements - links to the original elements are stored in scrawl.object
* scrawl.anim - for SpriteAnimation objects

@class window.scrawl_Images
**/

		/**
DOM document fragment
@property imageFragment
@type {Object}
@private
**/
		my.imageFragment = document.createDocumentFragment();
		/**
Utility canvas - never displayed
@property imageCanvas
@type {CasnvasObject}
@private
**/
		my.imageCanvas = document.createElement(&#x27;canvas&#x27;);
		my.imageCanvas.id = &#x27;imageHiddenCanvasElement&#x27;;
		my.imageFragment.appendChild(my.imageCanvas);
		/**
Utility canvas 2d context engine
@property imageCvx
@type {CasnvasContextObject}
@private
**/
		my.imageCvx = my.imageCanvas.getContext(&#x27;2d&#x27;);
		/**
Alias for makeImage()
@method newImage
@deprecated
@private
**/
		my.newImage = function(items) {
			return my.makeImage(items);
		};
		/**
Alias for makeSpriteAnimation()
@method newSpriteAnimation
@deprecated
**/
		my.newSpriteAnimation = function(items) {
			return my.makeSpriteAnimation(items);
		};
		/**
Alias for makeVideo()
method newVideo
@deprecated
@private
**/
		my.newVideo = function(items) {
			return my.makeVideo(items);
		};
		/**
A __factory__ function to generate new Image objects
@method makeImage
@param {Object} items Key:value Object argument for setting attributes
@return Image object
@private
**/
		my.makeImage = function(items) {
			return new my.Image(items);
		};
		/**
A __factory__ function to generate new SpriteAnimation objects
@method makeSpriteAnimation
@param {Object} items Key:value Object argument for setting attributes
@return SpriteAnimation object
**/
		my.makeSpriteAnimation = function(items) {
			return new my.SpriteAnimation(items);
		};
		/**
A __factory__ function to generate new Video objects
@method makeVideo
@param {Object} items Key:value Object argument for setting attributes
@return ScrawlImage object
@private
**/
		my.makeVideo = function(items) {
			return new my.Video(items);
		};

		my.workimg = {
			v1: my.makeVector(),
		};
		my.pushUnique(my.sectionlist, &#x27;image&#x27;);
		my.pushUnique(my.nameslist, &#x27;imagenames&#x27;);
		my.pushUnique(my.sectionlist, &#x27;video&#x27;);
		my.pushUnique(my.nameslist, &#x27;videonames&#x27;);
		my.pushUnique(my.sectionlist, &#x27;spriteanimation&#x27;);
		my.pushUnique(my.nameslist, &#x27;spriteanimationnames&#x27;);
		my.pushUnique(my.sectionlist, &#x27;asset&#x27;);
		my.pushUnique(my.nameslist, &#x27;assetnames&#x27;);
		/**
A __general__ function to generate Image wrapper objects for &amp;lt;img&amp;gt;, &amp;lt;video&amp;gt; or &amp;lt;svg&amp;gt; elements identified by class string
@method getImagesByClass
@param {String} classtag Class string value of DOM objects to be imported into the scrawl library
@param {Boolean} [kill] when set to true, the &amp;lt;img&amp;gt; elements will be removed from the DOM when imported into the library
@return true if one or more images are identified; false otherwise
**/
		my.getImagesByClass = function(classtag, kill) {
			var s,
				i;
			kill = my.xtGet(kill, true);
			if (classtag) {
				s = document.getElementsByClassName(classtag);
				if (s.length &gt; 0) {
					for (i = s.length; i &gt; 0; i--) {
						if (s[i - 1].width &amp;&amp; s[i - 1].height) {
							my.makeImage({
								element: s[i - 1],
								removeImageFromDOM: kill,
								crossOrigin: &#x27;anonymous&#x27;
							});
						}
						else {
							my.makeImage({
								url: s[i - 1].src,
								name: s[i - 1].id,
								removeImageFromDOM: kill,
								crossOrigin: &#x27;anonymous&#x27;
							});
						}
					}
					return true;
				}
			}
			return false;
		};
		/**
A __general__ function to generate a Image wrapper object for an &amp;lt;img&amp;gt; or &amp;lt;svg&amp;gt; element identified by an id string
@method getImageById
@param {String} idtag Id string value of DOM object to be imported into the scrawl library
@param {Boolean} [kill] when set to true, the &amp;lt;img&amp;gt; element will be removed from the DOM when imported into the library
@return true if image is identified; false otherwise
**/
		my.getImageById = function(idtag, kill) {
			var myImg;
			kill = my.xtGet(kill, true);
			if (idtag) {
				myImg = document.getElementById(idtag);
				if (myImg.width &amp;&amp; myImg.height) {
					my.makeImage({
						element: myImg,
						removeImageFromDOM: kill,
						crossOrigin: &#x27;anonymous&#x27;
					});
				}
				else {
					my.makeImage({
						url: myImg.src,
						name: myImg.id,
						removeImageFromDOM: kill,
						crossOrigin: &#x27;anonymous&#x27;
					});
				}
				return true;
			}
			return false;
		};
		/**
Helper function
@method getVideoCallback
@private
**/
		my.getVideoCallback = function() {
			my.makeVideo({
				element: this, //unrecorded flag for triggering Image stuff
				crossOrigin: &#x27;anonymous&#x27;
			});
		};
		/**
A __general__ function to generate a Video wrapper object for a &amp;lt;video&amp;gt; element identified by an id string
@method getVideoById
@param {String} idtag Id string value of DOM object to be imported into the scrawl library
@param {Boolean} [stream] defaults to &#x27;raw&#x27;
@return true if video is identified; false otherwise
**/
		my.getVideoById = function(idtag, stream) {
			var myVideo;
			stream = my.xtGet(stream, &#x27;raw&#x27;);
			if (idtag) {
				myVideo = document.getElementById(idtag);
				if (myVideo.readyState &gt; 1) {
					my.makeVideo({
						element: myVideo, //unrecorded flag for triggering Image stuff
						stream: stream,
						crossOrigin: &#x27;anonymous&#x27;
					});
				}
				else {
					myVideo.addEventListener(&#x27;loadeddata&#x27;, my.getVideoCallback, false);
				}
				return true;
			}
			return false;
		};

		/**
# Image

## Instantiation

* scrawl.getImagesByClass()

## Purpose

* Wraps DOM &amp;lt;img&amp;gt; elements imported into the scrawl library
* Used by __Picture__ entitys and __Pattern__ designs

## Access

* scrawl.image.IMAGENAME - for the Image object
* scrawl.asset.IMAGENAME - for a link to the original &amp;lt;img&amp;gt; element

@class Image
@constructor
@extends Base
@param {Object} [items] Key:value Object argument for setting attributes
**/
		my.Image = function(items) {
			var tempname;
			items = my.safeObject(items);
			this.width = 0;
			this.height = 0;
			if (my.xto(items.element, items.data, items.url)) {
				if (my.xt(items.element)) {
					items.name = my.xtGet(items.name, items.element.getAttribute(&#x27;id&#x27;), items.element.getAttribute(&#x27;name&#x27;), &#x27;&#x27;);
				}
				else if (my.xt(items.data)) {
					items.name = my.xtGet(items.name, &#x27;&#x27;);
				}
				else if (my.xt(items.url)) {
					tempname = items.url.substr(0, 128);
					items.name = my.xtGet(items.name, tempname, &#x27;&#x27;);
				}
				my.Base.call(this, items);
				my.image[this.name] = this;
				my.pushUnique(my.imagenames, this.name);
				if (my.xt(items.element)) {
					this.addImageByElement(items);
				}
				else if (my.xt(items.data)) {
					this.addImageByData(items);
				}
				else if (my.xt(items.url)) {
					this.addImageByUrl(items);
				}
				return this;
			}
			return false;
		};
		my.Image.prototype = Object.create(my.Base.prototype);
		/**
@property type
@type String
@default &#x27;Image&#x27;
@final
**/
		my.Image.prototype.type = &#x27;Image&#x27;;
		my.Image.prototype.classname = &#x27;imagenames&#x27;;
		my.d.Image = {
			/**
DOM image actual width, in pixels
@property width
@type Number
@default 0
**/
			width: 0,
			/**
DOM image actual height, in pixels
@property height
@type Number
@default 0
**/
			height: 0,
			/**
Constructor/clone flag - if set to true (default), will remove the &amp;lt;img&amp;gt; element from the web page DOM

_This attribute is not retained by the object_
@property removeImageFromDOM 
@type Boolean
@default true
**/
			/**
Constructor/clone function - some functions can call the Image constructor with a callback function

_This attribute is not retained by the object_
@property callback 
@type function
@default undefined - callback is always removed once run
**/
			/**
Constructor argument attribute - a DOM &amp;lt;img&amp;gt; element

_This attribute is not retained by the object_
@property element 
@type Object
@default undefined
**/
			/**
Constructor argument attribute - a canvas imageData object

_This attribute is not retained by the object_
@property data 
@type Object
@default undefined
**/
			/**
Constructor argument attribute - a String URL for dynamically loading an image

_This attribute is not retained by the object_
@property url 
@type Object
@default undefined
**/
		};
		my.mergeInto(my.d.Image, my.d.Base);
		/**
Adds a DOM &amp;lt;img&amp;gt; element to the library

* items.element MUST be a reference to the element, and the element MUST be present in the DOM

@method addImageByElement
@param {Object} [items] Key:value Object argument for setting attributes
@return always true
@private
**/
		my.Image.prototype.addImageByElement = function(items) {
			var el,
				kill = my.xtGet(items.removeImageFromDOM, true);
			if (kill) {
				el = items.element;
			}
			else {
				el = items.element.cloneNode();
			}
			el.id = this.name;
			this.width = parseFloat(my.xtGetTrue(el.offsetWidth, el.width, el.style.width, 1));
			this.height = parseFloat(my.xtGetTrue(el.offsetHeight, el.height, el.style.height, 1));
			my.imageFragment.appendChild(el);
			my.asset[this.name] = el;
			my.pushUnique(my.assetnames, this.name);
			if (my.isa(items.callback, &#x27;fn&#x27;)) {
				items.callback();
			}
			return true;
		};
		/**
Import an image using the supplied url string

@method addImageByUrl
@param {Object} [items] Key:value Object argument for setting attributes
@return true; false on failure
@private
**/
		my.Image.prototype.addImageByUrl = function(items) {
			var el,
				that = this;
			if (my.isa(items.url, &#x27;str&#x27;)) {
				el = document.createElement(&#x27;img&#x27;);
				el.id = this.name;
				el.onload = function() {
					var entity, design, i, iz, temp;
					that.width = el.width;
					that.height = el.height;
					my.imageFragment.appendChild(el);
					temp = &#x27;#&#x27; + that.name;
					my.asset[that.name] = my.imageFragment.querySelector(temp);
					my.pushUnique(my.assetnames, that.name);
					for (i = 0, iz = my.entitynames.length; i &lt; iz; i++) {
						entity = my.entity[my.entitynames[i]];
						if (entity.type === &#x27;Picture&#x27;) {
							if (entity.source === that.name) {
								entity.setCopy();
							}
						}
					}
					for (i = 0, iz = my.designnames.length; i &lt; iz; i++) {
						design = my.design[my.designnames[i]];
						if (design.type === &#x27;Pattern&#x27;) {
							if (design.source === that.name) {
								design.sourceType = &#x27;image&#x27;;
								design.makeDesign();
							}
						}
					}
					if (my.isa(items.callback, &#x27;fn&#x27;)) {
						items.callback();
					}
				};
				el.onerror = function(e) {};
				el.src = items.url;
				return true;
			}
			return false;
		};
		/**
Creates a new &amp;lt;img&amp;gt; element from a canvas ImageData object - uses Image.addImageByUrl() to achieve this

@method addImageByData
@param {Object} [items] Key:value Object argument for setting attributes
@return ImageDataUrl on success, false otherwise
@private
**/
		my.Image.prototype.addImageByData = function(items) {
			var data;
			if (my.xt(items.data)) {
				data = items.data;
				my.imageCanvas.width = data.width;
				my.imageCanvas.height = data.height;
				my.imageCvx.putImageData(data, 0, 0);
				items.url = my.imageCanvas.toDataURL(&#x27;image/png&#x27;);
				delete items.data;
				return this.addImageByUrl(items);
			}
			return false;
		};
		/**
Creates a new &amp;lt;img&amp;gt; element from an existing cell&#x27;s current display - uses Image.addImageByUrl() to achieve this

@method createImageFromCell
@param {String} cell - name of Cell to use as the base for the new Image
@param {String} [name] - id attribute for the new Image
@return ImageDataUrl on success, false otherwise
**/
		my.Image.prototype.createImageFromCell = function(cell, name) {
			var data,
				canvas;
			if (my.isa(cell, &#x27;str&#x27;)) {
				canvas = my.canvas[cell];
				cell = my.cell[cell];
				if (my.xt(canvas)) {
					data = canvas.toDataURL(&#x27;image/png&#x27;);
					if (my.xt(data)) {
						return this.addImageByUrl({
							url: data,
							name: my.xtGet(name, cell.name, &#x27;cell-image&#x27;),
							width: cell.actualWidth,
							height: cell.actualHeight
						});
					}
				}
			}
			return false;
		};
		/**
Clone an Image object

@method clone
@param {Object} [items] Key:value Object argument for setting attributes
@return new Image object on success; false otherwise
**/
		my.Image.prototype.clone = function(items) {
			items.element = my.imageFragment.getElementById(this.name).cloneNode();
			return my.makeImage(items);
		};

		/**
# SpriteAnimation

## Instantiation

* scrawl.makeSpriteAnimation()

## Purpose

* wraps a entity sheet image
* acts as the link between a Picture object and the entity images on the entity sheet
* holds data about cells in the entitysheet animation
* controls the animation playback

## Access

* scrawl.spriteanimation.SPRITEANIMATIONNAME
* scrawl.spriteanimation.[scrawl.entity.PICTURENAME.spriteAnimation]

SpriteAnimation attributes can also be set and retrieved directly using Picture.get() and Picture.set() functions, where a Picture entity is associated with the SpriteAnimation object via its .animSheet attribute

@class SpriteAnimation
@constructor
@extends Base
@param {Object} [items] Key:value Object argument for setting attributes
**/
		my.SpriteAnimation = function(items) {
			items = my.safeObject(items);
			my.Base.call(this, items);
			this.frames = (my.xt(items.frames)) ? [].concat(items.frames) : [];
			this.currentFrame = items.currentFrame || 0;
			this.speed = (my.isa(items.speed, &#x27;num&#x27;)) ? items.speed : 1;
			this.loop = (my.isa(items.loop, &#x27;str&#x27;)) ? items.loop : &#x27;end&#x27;;
			this.running = (my.isa(items.running, &#x27;str&#x27;)) ? items.running : &#x27;complete&#x27;;
			this.lastCalled = (my.xt(items.lastCalled)) ? items.lastCalled : Date.now();
			my.spriteanimation[this.name] = this;
			my.pushUnique(my.spriteanimationnames, this.name);
			return this;
		};
		my.SpriteAnimation.prototype = Object.create(my.Base.prototype);
		/**
@property type
@type String
@default &#x27;SpriteAnimation&#x27;
@final
**/
		my.SpriteAnimation.prototype.type = &#x27;SpriteAnimation&#x27;;
		my.SpriteAnimation.prototype.classname = &#x27;spriteanimationnames&#x27;;
		my.d.SpriteAnimation = {
			/**
An Array of animation frame data Objects, to be used for producing an animation sequence. Each Object in the Array has the following form:

* {x:Number, y:Number, w:Number, h:Number, d:Number}

... where:

* __x__ and __y__ represent the starting coordinates for the animation frame, in pixels, from the top left corner of the image
* __w__ and __h__ represent the dimensions of the animation frame, in pixels
* __d__ is the duration for each frame, in milliseconds

Animation frames are played in the order they are presented in this Array
@property frames
@type Array
@default []
**/
			frames: [],
			/**
The current frame of the animation, from frame 0
@property currentFrame
@type Number
@default 0
**/
			currentFrame: 0,
			/**
The speed at which the animation is to play. Values less than 1 will slow the animation, while values greater than one will speed it up. Setting the speed to 0 will pause the animation
@property speed
@type Number
@default 1
**/
			speed: 1,
			/**
Playback String; permitted values include:

* &#x27;pause&#x27; - pause the animation on the current frame
* &#x27;end&#x27; - play the animation once (default)
* &#x27;loop&#x27; - play the animation continuously 
* &#x27;reverse&#x27; - reverse the direction in which the animation runs
@property loop
@type String
@default &#x27;end&#x27;
**/
			loop: &#x27;end&#x27;,
			/**
Animation running String: permitted values include:

* &#x27;forward&#x27; - play the animation from the first frame towards the last frame
* &#x27;backward&#x27; - play the animation from the last frame towards the first frame
* &#x27;complete&#x27; - animation has reached the last (or first) frame and has completed
@property running
@type String
@default &#x27;complete&#x27;
**/
			running: &#x27;complete&#x27;,
			/**
Datestamp when SpriteAnimation.getData() function was last called
@property lastCalled
@type Date
@default 0
@private
**/
			lastCalled: 0,
		};
		my.animKeys = Object.keys(my.d.SpriteAnimation);
		my.mergeInto(my.d.SpriteAnimation, my.d.Scrawl);
		/**
Set attribute values - will also set the __currentFrame__ attribute to the appropriate value when the running __attribute__ is changed

(Only used by SpriteAnimation objects)
@method set
@param {Object} items Object containing attribute key:value pairs
@return This
@chainable
@private
**/
		my.SpriteAnimation.prototype.set = function(items) {
			var paused;
			items = my.safeObject(items);
			paused = (this.loop === &#x27;pause&#x27;) ? true : false;
			my.Base.prototype.set.call(this, items);
			if (my.xt(items.running)) {
				switch (items.running) {
					case &#x27;forward&#x27;:
						this.running = &#x27;forward&#x27;;
						if (!paused) {
							this.currentFrame = 0;
						}
						break;
					case &#x27;backward&#x27;:
						this.running = &#x27;backward&#x27;;
						if (!paused) {
							this.currentFrame = this.frames.length - 1;
						}
						break;
					default:
						this.running = &#x27;complete&#x27;;
						this.currentFrame = 0;
						break;
				}
			}
			return this;
		};
		/**
Returns an Object in the form {copyX:Number, copyY:Number, copyWidth:Number, copyHeight:Number}, representing the coordinates and dimensions of the current frame to be displayed by a Picture entity

(Only used by SpriteAnimation objects)
@method getData
@return Data object
@private
**/
		my.SpriteAnimation.prototype.getData = function() {
			var interval,
				changeFrame;
			if (this.speed &gt; 0) {
				interval = this.frames[this.currentFrame].d / this.speed;
				changeFrame = (this.lastCalled + interval &lt; Date.now()) ? true : false;
				switch (this.running) {
					case &#x27;complete&#x27;:
						this.lastCalled = Date.now();
						break;
					case &#x27;forward&#x27;:
						if (changeFrame) {
							switch (this.loop) {
								case &#x27;pause&#x27;:
									break;
								case &#x27;end&#x27;:
									this.running = (this.currentFrame + 1 &gt;= this.frames.length) ? &#x27;complete&#x27; : this.running;
									this.currentFrame = (this.currentFrame + 1 &gt;= this.frames.length) ? this.currentFrame : this.currentFrame + 1;
									break;
								case &#x27;loop&#x27;:
									this.currentFrame = (this.currentFrame + 1 &gt;= this.frames.length) ? 0 : this.currentFrame + 1;
									break;
								case &#x27;reverse&#x27;:
									this.running = (this.currentFrame + 1 &gt;= this.frames.length) ? &#x27;backward&#x27; : &#x27;forward&#x27;;
									this.currentFrame = (this.currentFrame + 1 &gt;= this.frames.length) ? this.currentFrame : this.currentFrame + 1;
									break;
							}
							this.lastCalled = Date.now();
						}
						break;
					case &#x27;backward&#x27;:
						if (changeFrame) {
							switch (this.loop) {
								case &#x27;pause&#x27;:
									break;
								case &#x27;end&#x27;:
									this.running = (this.currentFrame - 1 &lt;= 0) ? &#x27;complete&#x27; : this.running;
									this.currentFrame = (this.currentFrame - 1 &lt;= 0) ? this.currentFrame : this.currentFrame - 1;
									break;
								case &#x27;loop&#x27;:
									this.currentFrame = (this.currentFrame - 1 &lt;= 0) ? this.frames.length - 1 : this.currentFrame - 1;
									break;
								case &#x27;reverse&#x27;:
									this.running = (this.currentFrame - 1 &lt;= 0) ? &#x27;forward&#x27; : &#x27;backward&#x27;;
									this.currentFrame = (this.currentFrame - 1 &lt;= 0) ? this.currentFrame : this.currentFrame - 1;
									break;
							}
							this.lastCalled = Date.now();
						}
						break;
				}
			}
			return this.frames[this.currentFrame];
		};

		/**
# Video

## Instantiation

* scrawl.getVideoById()
* scrawl.makeVideo()

## Purpose

* Wraps DOM &amp;lt;video&amp;gt; elements imported into the scrawl library
* Used by __Picture__ entitys and __Pattern__ designs

## Access

* scrawl.video.VIDEONAME - for the Video object
* scrawl.asset.IMAGENAME - for a link to the original &amp;lt;video&amp;gt; element

@class Video
@constructor
@extends Base
@param {Object} [items] Key:value Object argument for setting attributes
**/
		my.Video = function(items) {
			var tempname;
			items = my.safeObject(items);
			this.width = 0;
			this.height = 0;
			if (my.xt(items.element)) {
				if (my.xt(items.element)) {
					items.name = my.xtGet(items.name, items.element.getAttribute(&#x27;id&#x27;), items.element.getAttribute(&#x27;name&#x27;), &#x27;&#x27;);
				}
				else if (my.xt(items.url)) {
					tempname = items.url.substr(0, 128);
					items.name = my.xtGet(items.name, tempname, &#x27;&#x27;);
				}
				my.Base.call(this, items);
				my.video[this.name] = this;
				my.pushUnique(my.videonames, this.name);
				this.addVideoByElement(items);
				return this;
			}
			return false;
		};
		my.Video.prototype = Object.create(my.Base.prototype);
		/**
    @property type
    @type String
    @default &#x27;Video&#x27;
    @final
    **/
		my.Video.prototype.type = &#x27;Video&#x27;;
		my.Video.prototype.classname = &#x27;videonames&#x27;;
		my.d.Video = {
			/**
    DOM image actual width, in pixels
    @property width
    @type Number
    @default 0
    **/
			width: 0,
			/**
    DOM image actual height, in pixels
    @property height
    @type Number
    @default 0
    **/
			height: 0,
			/**
Constructor/clone function - some functions can call the Video constructor with a callback function

_This attribute is not retained by the object_
@property callback 
@type function
@default undefined - callback is always removed once run
**/
			/**
Constructor argument attribute - a DOM &amp;lt;video&amp;gt; element

_This attribute is not retained by the object_
@property element 
@type Object
@default undefined
**/
		};
		my.mergeInto(my.d.Video, my.d.Base);
		/**
Adds a DOM &amp;lt;video&amp;gt; element to the library

* items.element MUST be a reference to the element, and the element MUST be present in the DOM

@method addVideoByElement
@param {Object} [items] Key:value Object argument for setting attributes
@return always true
@private
**/
		my.Video.prototype.addVideoByElement = function(items) {
			var el = items.element;
			if (my.xt(el)) {
				el.id = this.name;
				this.width = 1;
				this.height = 1;
				my.imageFragment.appendChild(el);
				my.asset[this.name] = my.imageFragment.querySelector(&#x27;#&#x27; + this.name);
				my.pushUnique(my.assetnames, this.name);
				this.api = my.asset[this.name];
				if (this.api.readyState &gt; 0) {
					this.setIntrinsicDimensions();
				}
				else {
					this.api.addEventListener(&#x27;loadedmetadata&#x27;, this.setIntrinsicDimensions, false);
				}
				if (my.isa(items.callback, &#x27;fn&#x27;)) {
					items.callback();
				}
				return true;
			}
			return false;
		};
		/**
Video constructor helper function

@method setIntrinsicDimensions
@return always true
@private
**/
		my.Video.prototype.setIntrinsicDimensions = function() {
			var ent,
				api,
				wrapper,
				i,
				iz;
			if (my.xt(this.api)) {
				//this = scrawl wrapper
				api = this.api;
				wrapper = this;
			}
			else {
				//this = dom video element
				api = this;
				wrapper = my.video[this.id];
			}
			wrapper.width = api.videoWidth;
			wrapper.height = api.videoHeight;
			for (i = 0, iz = my.entitynames.length; i &lt; iz; i++) {
				ent = my.entity[my.entitynames[i]];
				if (ent.type === &#x27;Picture&#x27;) {
					ent.setCopy();
				}
			}
			return true;
		};
		/**
Import a video using the supplied url string

@method addImageByUrl
@param {Object} [items] Key:value Object argument for setting attributes
@return true; false on failure
@private
**/
		my.Video.prototype.addVideoByUrl = function(items) {
			return false;
		};

		return my;
	}(scrawl));
}

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
