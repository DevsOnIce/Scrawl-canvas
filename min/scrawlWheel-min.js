/*! scrawl-canvas 2015-05-13 */
if(window.scrawl&&window.scrawl.modules&&!window.scrawl.contains(window.scrawl.modules,"wheel"))var scrawl=function(a){"use strict";return a.newWheel=function(b){return a.makeWheel(b)},a.makeWheel=function(b){return new a.Wheel(b)},a.workwheel={v1:a.makeVector()},a.Wheel=function(b){return b=a.safeObject(b),a.Entity.call(this,b),a.Position.prototype.set.call(this,b),this.radius=a.xtGet(b.radius,a.d.Wheel.radius),this.width=2*this.radius,this.height=this.width,this.checkHitUsingRadius=a.xtGet(b.checkHitUsingRadius,a.d.Wheel.checkHitUsingRadius),this.closed=a.xtGet(b.closed,a.d.Wheel.closed),this.includeCenter=a.xtGet(b.includeCenter,a.d.Wheel.includeCenter),this.clockwise=a.xtGet(b.clockwise,a.d.Wheel.clockwise),this.registerInLibrary(),a.pushUnique(a.group[this.group].entitys,this.name),this},a.Wheel.prototype=Object.create(a.Entity.prototype),a.Wheel.prototype.type="Wheel",a.Wheel.prototype.classname="entitynames",a.d.Wheel={startAngle:0,endAngle:360,clockwise:!1,closed:!0,includeCenter:!1,checkHitUsingRadius:!0,checkHitRadius:0},a.mergeInto(a.d.Wheel,a.d.Entity),a.Wheel.prototype.set=function(b){return a.Entity.prototype.set.call(this,b),this.radius=a.xtGet(b.radius,this.radius),this.width=2*this.radius,this.height=this.width,this},a.Wheel.prototype.setDelta=function(b){return a.Entity.prototype.setDelta.call(this,b),b=a.isa(b,"obj")?b:{},a.xt(b.radius)&&(this.radius+=b.radius,this.width=2*this.radius,this.height=this.width),a.xt(b.startAngle)&&(this.startAngle=this.get("startAngle")+b.startAngle),a.xt(b.endAngle)&&(this.endAngle=this.get("endAngle")+b.endAngle),this},a.Wheel.prototype.checkHit=function(b){var c,d,e,f,g;if(b=a.safeObject(b),e=a.xt(b.tests)?b.tests:[b.x||!1,b.y||!1],f=!1,this.checkHitUsingRadius){for(g=this.checkHitRadius?this.checkHitRadius:this.radius*this.scale,c=0,d=e.length;d>c;c+=2)if(this.resetWork(),a.workwheel.v1.x=e[c],a.workwheel.v1.y=e[c+1],a.workwheel.v1.vectorSubtract(this.work.start).scalarDivide(this.scale).rotate(-this.roll),a.workwheel.v1.x=this.flipReverse?-a.workwheel.v1.x:a.workwheel.v1.x,a.workwheel.v1.y=this.flipUpend?-a.workwheel.v1.y:a.workwheel.v1.y,a.workwheel.v1.vectorAdd(this.getPivotOffsetVector(this.handle)),f=a.workwheel.v1.getMagnitude()<=g?!0:!1){b.x=e[c],b.y=e[c+1];break}}else for(this.buildPath(a.cvx),c=0,d=e.length;d>c;c+=2)if(f=a.cvx.isPointInPath(e[c],e[c+1])){b.x=e[c],b.y=e[c+1];break}return f?b:!1},a.Wheel.prototype.getPivotOffsetVector=function(){return this.getCenteredPivotOffsetVector()},a.Wheel.prototype.buildPath=function(b,c){var d,e,f;return d=this.prepareStamp(),e=this.startAngle||0,f=this.endAngle||360,this.rotateCell(b,c),b.beginPath(),b.arc(d.x,d.y,this.radius*this.scale,e*a.radian,f*a.radian,this.clockwise),this.includeCenter&&b.lineTo(d.x,d.y),this.closed&&b.closePath(),this},a.Wheel.prototype.clip=function(a,b){return this.buildPath(a,b),a.clip(),this},a.Wheel.prototype.clear=function(b,c){return b.globalCompositeOperation="destination-out",this.buildPath(b,c),b.stroke(),b.fill(),b.globalCompositeOperation=a.ctx[c].get("globalCompositeOperation"),this},a.Wheel.prototype.clearWithBackground=function(b,c){var d,e,f,g,h,i;return d=a.cell[c],e=d.get("backgroundColor"),f=a.ctx[c],g=f.get("fillStyle"),h=f.get("strokeStyle"),i=f.get("globalAlpha"),b.fillStyle=e,b.strokeStyle=e,b.globalAlpha=1,this.buildPath(b,c),b.stroke(),b.fill(),b.fillStyle=g,b.strokeStyle=h,b.globalAlpha=i,this},a.Wheel.prototype.draw=function(b,c){return a.cell[c].setEngine(this),this.buildPath(b,c),b.stroke(),this},a.Wheel.prototype.fill=function(b,c){return a.cell[c].setEngine(this),this.buildPath(b,c),b.fill(),this},a.Wheel.prototype.drawFill=function(b,c){return a.cell[c].setEngine(this),this.buildPath(b,c),b.stroke(),this.clearShadow(b,c),b.fill(),this},a.Wheel.prototype.fillDraw=function(b,c){return a.cell[c].setEngine(this),this.buildPath(b,c),b.fill(),this.clearShadow(b,c),b.stroke(),this},a.Wheel.prototype.sinkInto=function(b,c){return a.cell[c].setEngine(this),this.buildPath(b,c),b.fill(),b.stroke(),this},a.Wheel.prototype.floatOver=function(b,c){return a.cell[c].setEngine(this),this.buildPath(b,c),b.stroke(),b.fill(),this},a.Wheel.prototype.none=function(a,b){return this.buildPath(a,b),this},a.Wheel.prototype.buildCollisionVectors=function(b){var c,d,e,f,g;if(a.xt(a.workcols))for(this.collisionVectors.length=0,a.workcols.v1.x=this.radius,a.workcols.v1.y=0,c=a.xt(b)?this.parseCollisionPoints(b):this.collisionPoints,e=0,f=c.length;f>e;e++)if(a.isa(c[e],"num")&&c[e]>1)for(a.workcols.v2.set(a.workcols.v1),d=360/Math.floor(c[e]),g=0;g<c[e];g++)a.workcols.v2.rotate(d),this.collisionVectors.push(a.workcols.v2.x),this.collisionVectors.push(a.workcols.v2.y);else if(a.isa(c[e],"str"))switch(a.workcols.v2.set(a.workcols.v1),c[e]){case"start":this.collisionVectors.push(0),this.collisionVectors.push(0);break;case"N":a.workcols.v2.rotate(-90),this.collisionVectors.push(a.workcols.v2.x),this.collisionVectors.push(a.workcols.v2.y);break;case"NE":a.workcols.v2.rotate(-45),this.collisionVectors.push(a.workcols.v2.x),this.collisionVectors.push(a.workcols.v2.y);break;case"E":this.collisionVectors.push(a.workcols.v2.x),this.collisionVectors.push(a.workcols.v2.y);break;case"SE":a.workcols.v2.rotate(45),this.collisionVectors.push(a.workcols.v2.x),this.collisionVectors.push(a.workcols.v2.y);break;case"S":a.workcols.v2.rotate(90),this.collisionVectors.push(a.workcols.v2.x),this.collisionVectors.push(a.workcols.v2.y);break;case"SW":a.workcols.v2.rotate(135),this.collisionVectors.push(a.workcols.v2.x),this.collisionVectors.push(a.workcols.v2.y);break;case"W":a.workcols.v2.rotate(180),this.collisionVectors.push(a.workcols.v2.x),this.collisionVectors.push(a.workcols.v2.y);break;case"NW":a.workcols.v2.rotate(-135),this.collisionVectors.push(a.workcols.v2.x),this.collisionVectors.push(a.workcols.v2.y);break;case"center":this.collisionVectors.push(0),this.collisionVectors.push(0)}else a.isa(c[e],"vector")&&(this.collisionVectors.push(c[e].x),this.collisionVectors.push(c[e].y));return this},a}(scrawl);