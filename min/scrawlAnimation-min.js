/*! scrawl-canvas 2015-01-07 */
if(window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,1e3/60)}}(),window.scrawl&&window.scrawl.modules&&!window.scrawl.contains(window.scrawl.modules,"animation"))var scrawl=function(a){"use strict";return a.animationInit=function(){a.doAnimation=!0,a.animationLoop()},a.d.Position.delta={x:0,y:0,z:0},a.d.Position.deltaPathPlace=0,a.d.Position.pathSpeedConstant=!0,a.mergeInto(a.d.Cell,a.d.Position),a.mergeInto(a.d.Entity,a.d.Position),a.xt(a.d.Block)&&a.mergeInto(a.d.Block,a.d.Entity),a.xt(a.d.Shape)&&a.mergeInto(a.d.Shape,a.d.Entity),a.xt(a.d.Wheel)&&a.mergeInto(a.d.Wheel,a.d.Entity),a.xt(a.d.Picture)&&a.mergeInto(a.d.Picture,a.d.Entity),a.xt(a.d.Phrase)&&a.mergeInto(a.d.Phrase,a.d.Entity),a.xt(a.d.Path)&&a.mergeInto(a.d.Path,a.d.Entity),a.Position.prototype.animationPositionInit=function(b){var c=a.safeObject(b.delta);this.delta=a.newVector({x:a.xtGet(b.deltaX,c.x,0),y:a.xtGet(b.deltaY,c.y,0)}),this.work.delta=a.newVector({name:this.type+"."+this.name+".work.delta"}),this.pathSpeedConstant=a.xtGet(b.pathSpeedConstant,a.d[this.type].pathSpeedConstant),this.deltaPathPlace=a.xtGet(b.deltaPathPlace,a.d[this.type].deltaPathPlace)},a.Position.prototype.animationPositionGet=function(b){var c=["deltaX","deltaY"];if(a.contains(c,b))switch(b){case"deltaX":return this.delta.x;case"deltaY":return this.delta.y}return"delta"===b?(console.log(this.name,"get delta vector"),this.delta.getVector()):!1},a.Position.prototype.animationPositionSet=function(b){a.xto(b.delta,b.deltaX,b.deltaY)&&this.setDeltaAttribute(b)},a.Position.prototype.setDeltaAttribute=function(b){var c;return b=a.safeObject(b),a.isa(this.delta,"vector")||(this.delta=a.newVector(b.delta||this.delta)),c=a.safeObject(b.delta),this.delta.x=a.xtGet(b.deltaX,c.x,this.delta.x),this.delta.y=a.xtGet(b.deltaY,c.y,this.delta.y),this},a.Position.prototype.animationPositionClone=function(b,c){var d=a.safeObject(c.delta);return b.delta=a.newVector({x:a.xtGet(c.deltaX,d.x,b.delta.x),y:a.xtGet(c.deltaY,d.y,b.delta.y)}),b},a.Position.prototype.updateStart=function(b){switch(b){case"x":this.start.x=a.isa(this.start.x,"num")?this.start.x+this.delta.x:a.addPercentages(this.start.x,this.delta.x||0);break;case"y":this.start.y=a.isa(this.start.y,"num")?this.start.y+this.delta.y:a.addPercentages(this.start.y,this.delta.y||0);break;case"path":this.pathPlace=a.addWithinBounds(this.pathPlace,this.deltaPathPlace,{action:"loop"});break;default:this.pathPlace=a.addWithinBounds(this.pathPlace,this.deltaPathPlace||0,{action:"loop"}),this.start.x=a.isa(this.start.x,"num")?this.start.x+this.delta.x:a.addPercentages(this.start.x,this.delta.x||0),this.start.y=a.isa(this.start.y,"num")?this.start.y+this.delta.y:a.addPercentages(this.start.y,this.delta.y||0)}return a.xt(this.collisionArray)&&(this.collisionArray.length=0),this},a.Position.prototype.revertStart=function(b){switch(b){case"x":this.start.x=a.isa(this.start.x,"num")?this.start.x-this.delta.x:a.subtractPercentages(this.start.x,this.delta.x||0);break;case"y":this.start.y=a.isa(this.start.y,"num")?this.start.y-this.delta.y:a.subtractPercentages(this.start.y,this.delta.y||0);break;case"path":this.pathPlace=a.addWithinBounds(this.pathPlace,this.deltaPathPlace,{action:"loop",operation:"-"});break;default:this.pathPlace=a.addWithinBounds(this.pathPlace,this.deltaPathPlace||0,{action:"loop",operation:"-"}),this.start.x=a.isa(this.start.x,"num")?this.start.x-this.delta.x:a.subtractPercentages(this.start.x,this.delta.x||0),this.start.y=a.isa(this.start.y,"num")?this.start.y-this.delta.y:a.subtractPercentages(this.start.y,this.delta.y||0)}return a.xt(this.collisionArray)&&(this.collisionArray.length=0),this},a.Position.prototype.exchange=function(b,c){var d;return a.isa(b,"obj")&&(d=this[c]||this.get(c),this[c]=b[c]||b.get(c),b[c]=d),this},a.Position.prototype.reverse=function(b){switch(b){case"deltaX":this.delta.x=a.isa(this.delta.x,"num")?-this.delta.x:a.reversePercentage(this.delta.x);break;case"deltaY":this.delta.y=a.isa(this.delta.y,"num")?-this.delta.y:a.reversePercentage(this.delta.y);break;case"delta":this.delta.x=a.isa(this.delta.x,"num")?-this.delta.x:a.reversePercentage(this.delta.x),this.delta.y=a.isa(this.delta.y,"num")?-this.delta.y:a.reversePercentage(this.delta.y);break;case"deltaPathPlace":this.deltaPathPlace=-this.deltaPathPlace;break;default:this.deltaPathPlace=-this.deltaPathPlace,this.delta.x=a.isa(this.delta.x,"num")?-this.delta.x:a.reversePercentage(this.delta.x),this.delta.y=a.isa(this.delta.y,"num")?-this.delta.y:a.reversePercentage(this.delta.y)}return this},a.d.Cell.copyDelta={x:0,y:0},a.d.Cell.copyMinWidth=0,a.d.Cell.copyMaxWidth=0,a.d.Cell.copyMinHeight=0,a.d.Cell.copyMaxHeight=0,a.Cell.prototype.animationCellInit=function(b){var c=a.safeObject(b.copyDelta);this.copyDelta=a.newVector({x:a.xtGet(b.copyDeltaX,c.x,0),y:a.xtGet(b.copyDeltaY,c.y,0)}),this.work.copyDelta=a.newVector()},a.Cell.prototype.animationCellGet=function(b){var c=["copyDeltaX","copyDeltaY"];if(a.contains(c,b))switch(b){case"copyDeltaX":return this.copyDelta.x;case"copyDeltaY":return this.copyDelta.y}return a.Base.prototype.get.call(this,b)},a.Cell.prototype.animationCellSet=function(b){var c;a.xto(b.copyDelta,b.copyDeltaX,b.copyDeltaY)&&(c=a.safeObject(b.copyDelta),this.copyDelta.x=a.xtGet(b.copyDeltaX,c.x,this.copyDelta.x),this.copyDelta.y=a.xtGet(b.copyDeltaY,c.y,this.copyDelta.y))},a.Cell.prototype.updateStart=function(b){switch(b){case"x":this.start.x=a.isa(this.start.x,"num")?this.start.x+this.delta.x:a.addPercentages(this.start.x,this.delta.x||0),this.copy.x=a.isa(this.copy.x,"num")?this.copy.x+this.copyDelta.x:a.addPercentages(this.copy.x,this.copyDelta.x||0);break;case"y":this.start.y=a.isa(this.start.y,"num")?this.start.y+this.delta.y:a.addPercentages(this.start.y,this.delta.y||0),this.copy.y=a.isa(this.copy.y,"num")?this.copy.y+this.copyDelta.y:a.addPercentages(this.copy.y,this.copyDelta.y||0);break;case"start":case"paste":this.start.x=a.isa(this.start.x,"num")?this.start.x+this.delta.x:a.addPercentages(this.start.x,this.delta.x||0),this.start.y=a.isa(this.start.y,"num")?this.start.y+this.delta.y:a.addPercentages(this.start.y,this.delta.y||0);break;case"copy":this.copy.x=a.isa(this.copy.x,"num")?this.copy.x+this.copyDelta.x:a.addPercentages(this.copy.x,this.copyDelta.x||0),this.copy.y=a.isa(this.copy.y,"num")?this.copy.y+this.copyDelta.y:a.addPercentages(this.copy.y,this.copyDelta.y||0);break;case"path":this.pathPlace=a.addWithinBounds(this.pathPlace,this.deltaPathPlace,{action:"loop"});break;default:a.xt(this.pathPlace)&&(this.pathPlace=a.addWithinBounds(this.pathPlace,this.deltaPathPlace||0,{action:"loop"})),this.start.x=a.isa(this.start.x,"num")?this.start.x+this.delta.x:a.addPercentages(this.start.x,this.delta.x||0),this.start.y=a.isa(this.start.y,"num")?this.start.y+this.delta.y:a.addPercentages(this.start.y,this.delta.y||0),this.copy.x=a.isa(this.copy.x,"num")?this.copy.x+this.copyDelta.x:a.addPercentages(this.copy.x,this.copyDelta.x||0),this.copy.y=a.isa(this.copy.y,"num")?this.copy.y+this.copyDelta.y:a.addPercentages(this.copy.y,this.copyDelta.y||0)}return this.setCopy(),this.setPaste(),this},a.Cell.prototype.revertStart=function(b){switch(b){case"x":this.start.x=a.isa(this.start.x,"num")?this.start.x-this.delta.x:this.subtractPercentages(this.start.x,this.delta.x||0),this.copy.x=a.isa(this.copy.x,"num")?this.copy.x-this.copyDelta.x:this.subtractPercentages(this.copy.x,this.copyDelta.x||0);break;case"y":this.start.y=a.isa(this.start.y,"num")?this.start.y-this.delta.y:this.subtractPercentages(this.start.y,this.delta.y||0),this.copy.y=a.isa(this.copy.y,"num")?this.copy.y-this.copyDelta.y:this.subtractPercentages(this.copy.y,this.copyDelta.y||0);break;case"start":case"paste":this.start.x=a.isa(this.start.x,"num")?this.start.x-this.delta.x:this.subtractPercentages(this.start.x,this.delta.x||0),this.start.y=a.isa(this.start.y,"num")?this.start.y-this.delta.y:this.subtractPercentages(this.start.y,this.delta.y||0);break;case"copy":this.copy.x=a.isa(this.copy.x,"num")?this.copy.x-this.copyDelta.x:this.subtractPercentages(this.copy.x,this.copyDelta.x||0),this.copy.y=a.isa(this.copy.y,"num")?this.copy.y-this.copyDelta.y:this.subtractPercentages(this.copy.y,this.copyDelta.y||0);break;case"path":this.pathPlace=a.addWithinBounds(this.pathPlace,this.deltaPathPlace,{action:"loop",operation:"-"});break;default:a.xt(this.pathPlace)&&(this.pathPlace=a.addWithinBounds(this.pathPlace,this.deltaPathPlace||0,{action:"loop",operation:"-"})),this.start.x=a.isa(this.start.x,"num")?this.start.x-this.delta.x:this.subtractPercentages(this.start.x,this.delta.x||0),this.start.y=a.isa(this.start.y,"num")?this.start.y-this.delta.y:this.subtractPercentages(this.start.y,this.delta.y||0),this.copy.x=a.isa(this.copy.x,"num")?this.copy.x-this.copyDelta.x:this.subtractPercentages(this.copy.x,this.copyDelta.x||0),this.copy.y=a.isa(this.copy.y,"num")?this.copy.y-this.copyDelta.y:this.subtractPercentages(this.copy.y,this.copyDelta.y||0)}return this.setCopy(),this.setPaste(),this},a.Cell.prototype.zoom=function(b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p;return a.isa(b,"num")&&(c=this.copyWidth,d=this.copyHeight,e=this.actualWidth,f=this.actualHeight,g=a.xtGet(this.copyMinWidth,this.copyWidth),h=a.xtGet(this.copyMinHeight,this.copyHeight),i=a.xtGet(this.copyMaxWidth,this.copyWidth),j=a.xtGet(this.copyMaxHeight,this.copyHeight),k=this.copy.x,l=this.copy.y,m=c+b,n=d+b,a.isBetween(m,g,i,!0)&&a.isBetween(n,h,j,!0)&&(c=m,o=k-b/2,k=0>o?0:o>e-c?e-c:o,d=n,p=l-b/2,l=0>p?0:p>f-d?f-d:p,this.copy.x=k,this.copy.y=l,this.copyWidth=c,this.copyHeight=d)),this},a.Cell.prototype.spliceCell=function(b){var c,d,e,f,g,h,i,j,k=["horizontal","vertical","top","bottom","left","right"];if(b=a.safeObject(b),a.contains(k,b.edge)){switch(f=a.xtGet(b.shiftCopy,!1),g=this.actualHeight,h=this.actualWidth,i=a.context[this.name],j=a.canvas[this.name],a.cv.width=h,a.cv.height=g,i.setTransform(1,0,0,1,0,0),b.edge){case"horizontal":d=h/2,c=d,e="left";break;case"vertical":d=g/2,c=d,e="top";break;case"top":case"bottom":c=a.xtGet(b.strip,20),d=g-c,e=b.edge;break;case"left":case"right":c=a.xtGet(b.strip,20),d=h-c,e=b.edge}switch(e){case"top":a.cvx.drawImage(j,0,0,h,c,0,d,h,c),a.cvx.drawImage(j,0,c,h,d,0,0,h,d),this.copy.y-=f?c:0;break;case"bottom":a.cvx.drawImage(j,0,0,h,d,0,c,h,d),a.cvx.drawImage(j,0,d,h,c,0,0,h,c),this.copy.y+=f?c:0;break;case"left":a.cvx.drawImage(j,0,0,c,g,d,0,c,g),a.cvx.drawImage(j,c,0,d,g,0,0,d,g),this.copy.x-=f?c:0;break;case"right":a.cvx.drawImage(j,0,0,d,g,c,0,d,g),a.cvx.drawImage(j,d,0,c,g,0,0,c,g),this.copy.x+=f?c:0}i.clearRect(0,0,h,g),i.drawImage(a.cv,0,0,h,g),f&&this.setCopy()}return this},a.Group.prototype.updateStart=function(b){for(var c=0,d=this.entitys.length;d>c;c++)a.entity[this.entitys[c]].updateStart(b);return this},a.Group.prototype.revertStart=function(b){for(var c=0,d=this.entitys.length;d>c;c++)a.entity[this.entitys[c]].revertStart(b);return this},a.Group.prototype.reverse=function(b){for(var c=0,d=this.entitys.length;d>c;c++)a.entity[this.entitys[c]].reverse(b);return this},a.d.Design.shift=0,a.d.Design.autoUpdate=!1,a.mergeInto(a.d.Gradient,a.d.Design),a.mergeInto(a.d.RadialGradient,a.d.Design),a.xt(a.d.Pattern)&&a.mergeInto(a.d.Pattern,a.d.Design),a.Design.prototype.update=function(a,b){return this.makeGradient(a,b),this.sortStops(),this.applyStops(),this},a.Design.prototype.sortStops=function(){var b,c,d,e;for(b=this.get("color"),c=this.get("shift"),d=0,e=b.length;e>d;d++)b[d].stop+=c,a.isBetween(b[d].stop,0,1,!0)||(b[d].stop=b[d].stop>.5?b[d].stop-1:b[d].stop+1),b[d].stop<=0?b[d].stop=1e-6:b[d].stop>=1&&(b[d].stop=.999999);b.sort(function(a,b){return a.stop-b.stop}),this.color=b},a.newAnimation=function(b){return new a.Animation(b)},a.newTween=function(b){return new a.Tween(b)},a.pushUnique(a.sectionlist,"animation"),a.pushUnique(a.nameslist,"animate"),a.pushUnique(a.nameslist,"animationnames"),a.doAnimation=!1,a.orderAnimations=!0,a.animationLoop=function(){var b,c;for(a.orderAnimations&&a.sortAnimations(),b=0,c=a.animate.length;c>b;b++)a.animate[b]&&a.animation[a.animate[b]].fn();a.doAnimation&&window.requestAnimFrame(function(){a.animationLoop()})},a.sortAnimations=function(){a.animate.sort(function(b,c){return a.animation[b].order-a.animation[c].order})},a.Animation=function(b){var c;return a.Base.call(this,b),b=a.safeObject(b),c=a.isa(b.delay,"bool")?b.delay:!1,this.fn=b.fn||function(){},this.order=b.order||0,a.animation[this.name]=this,a.pushUnique(a.animationnames,this.name),c||this.run(),this},a.Animation.prototype=Object.create(a.Base.prototype),a.Animation.prototype.type="Animation",a.Animation.prototype.classname="animationnames",a.d.Animation={fn:function(){},order:0},a.mergeInto(a.d.Animation,a.d.Base),a.Animation.prototype.run=function(){return a.pushUnique(a.animate,this.name),!0},a.Animation.prototype.halt=function(){return a.removeItem(a.animate,this.name),!0},a.Animation.prototype.kill=function(){return delete a.animation[this.name],a.removeItem(a.animationnames,this.name),a.removeItem(a.animate,this.name),!0},a.Tween=function(b){return a.Base.call(this,b),b=a.safeObject(b),this.targets=a.isa(b.targets,"arr")?b.targets:a.xt(b.targets)?[b.targets]:[],this.currentTargets=[],this.initVals=[],this.start=a.isa(b.start,"obj")?b.start:{},this.engines=a.isa(b.engines,"obj")?b.engines:{},this.end=a.isa(b.end,"obj")?b.end:{},this.startTime=Date.now(),this.duration=b.duration||0,this.active=!1,this.reverse=b.reverse||!1,this.autoReverse=b.autoReverse||!1,this.autoReverseAndRun=b.autoReverseAndRun||!1,this.count=b.count||0,this.currentCount=0,this.onCommence=b.onCommence||{},this.onComplete=b.onComplete||{},this.nextTween=b.nextTween||"",this.killOnComplete=b.killOnComplete||!1,this.callback=a.isa(b.callback,"fn")?b.callback:!1,this.order=b.order||0,a.animation[this.name]=this,a.pushUnique(a.animationnames,this.name),this},a.Tween.prototype=Object.create(a.Base.prototype),a.Tween.prototype.type="Tween",a.Tween.prototype.classname="animationnames",a.d.Tween={targets:[],currentTargets:[],start:{},engines:{},end:{},onComplete:{},initVals:[],onCommence:{},startTime:0,duration:0,active:!1,reverse:!1,autoReverse:!1,callback:!1,autoReverseAndRun:!1,count:0,currentCount:0,killOnComplete:!1,nextTween:"",order:0},a.mergeInto(a.d.Tween,a.d.Base),a.Tween.prototype.fn=function(){var b,c,d,e,f,g,h,i,j,k,l;if(b=Date.now(),c=(b-this.startTime)/this.duration,f=Object.keys(this.end),this.active)if(1>c){for(i=0,j=this.currentTargets.length;j>i;i++)if(d=this.currentTargets[i],a.xt(d)){for(e={},k=0,l=f.length;l>k;k++)g=this.initVals[i][f[k]],h=a.isa(g.start,"str")||a.isa(g.change,"str")?!0:!1,e[f[k]]=this.engine(parseFloat(g.start),parseFloat(g.change),c,this.engines[f[k]],this.reverse),e[f[k]]=h?e[f[k]]+"%":e[f[k]];d.set(e)}}else this.halt(),(this.autoReverse||this.autoReverseAndRun)&&(this.reverse=this.reverse?!1:!0),this.autoReverseAndRun?a.isa(this.currentCount,"num")?(this.currentCount--,this.currentCount>0?this.run():this.runComplete()):this.run():this.runComplete();return!0},a.Tween.prototype.engine=function(b,c,d,e){var f;if(e=a.xtGet(e,"x"),e.length<4)switch(e){case"out":return f=1-d,b+c+Math.cos(90*d*a.radian)*-c;case"in":return b+Math.sin(90*d*a.radian)*c;default:return b+d*c}if("I"==e[4])switch(e){case"easeIn":return f=1-d,b+c+f*f*-c;case"easeIn3":return f=1-d,b+c+f*f*f*-c;case"easeIn4":return f=1-d,b+c+f*f*f*f*-c;case"easeIn5":return f=1-d,b+c+f*f*f*f*f*-c;default:return b+d*c}if(e.length>8)switch(e){case"easeOutIn":return f=1-d,.5>d?b+d*d*c*2:b+c+f*f*-c*2;case"easeOutIn3":return f=1-d,.5>d?b+d*d*d*c*4:b+c+f*f*f*-c*4;case"easeOutIn4":return f=1-d,.5>d?b+d*d*d*d*c*8:b+c+f*f*f*f*-c*8;case"easeOutIn5":return f=1-d,.5>d?b+d*d*d*d*d*c*16:b+c+f*f*f*f*f*-c*16;default:return b+d*c}switch(e){case"easeOut":return b+d*d*c;case"easeOut3":return b+d*d*d*c;case"easeOut4":return b+d*d*d*d*c;case"easeOut5":return b+d*d*d*d*d*c;default:return b+d*c}},a.Tween.prototype.run=function(){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v;if(j=a.subtractPercentages,!this.active){for(c=[],e=Object.keys(this.end),this.currentCount=this.currentCount||this.count,this.currentTargets=[],this.initVals=[],u=0,v=a.animationnames.length;v>u;u++)d=a.animation[a.animationnames[u]],"Tween"===d.type&&d.active&&d.name!==this.name&&c.push(d);for(k=0,l=this.targets.length;l>k;k++){for(b=!0,m=0,n=c.length;n>m;m++){for(o=0,p=c[m].currentTargets.length;p>o;o++)if(this.targets[k].name===c[m].currentTargets[o].name){b=!1;break}if(!b)break}b&&this.currentTargets.push(this.targets[k])}if(this.currentTargets.length>0){for(q=0,r=this.currentTargets.length;r>q;q++)if(a.xt(this.currentTargets[q]))for(this.currentTargets[q].set(this.onCommence),this.initVals.push({}),s=0,t=e.length;t>s;s++)f=a.xt(this.start[e[s]])?this.start[e[s]]:this.currentTargets[q].get([e[s]]),g=this.end[e[s]],h=a.isa(f,"str")||a.isa(g,"str")?!0:!1,i=h?j(g,f):g-f,this.reverse&&(i=h?-parseFloat(i)+"%":-i),this.initVals[q][e[s]]={start:this.reverse?g:f,change:i};return this.startTime=Date.now(),a.pushUnique(a.animate,this.name),this.active=!0,!0}}return!1},a.Tween.prototype.runComplete=function(){var b,c;for(b=0,c=this.currentTargets.length;c>b;b++)a.xt(this.currentTargets[b])&&this.currentTargets[b].set(this.onComplete);return this.nextTween?a.xt(a.animation[this.nextTween])&&a.animation[this.nextTween].run():this.callback&&this.callback(),this.killOnComplete&&this.kill(),!0},a.Tween.prototype.halt=function(){return this.active=!1,a.removeItem(a.animate,this.name),!0},a.Tween.prototype.kill=function(){var b,c;if(this.active)for(b=0,c=this.currentTargets.length;c>b;b++)a.xt(this.currentTargets[b])&&this.currentTargets[b].set(this.onComplete);return a.removeItem(a.animate,this.name),a.removeItem(a.animationnames,this.name),delete a.animation[this.name],!0},a}(scrawl);