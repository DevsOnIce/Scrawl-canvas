<!DOCTYPE html>
<html>

<head>
  <title>Demo 092</title>
  <link href="css/normalize.css" rel="stylesheet" />
  <link href="css/demo.css" rel="stylesheet" />
</head>

<body>
  <h1><a href="index.html">Scrawl.js</a> - demonstration 092</h1>
  <h2>Spotlight effect using gradient</h2>
  <h3>Modules: block, images, animation</h3>
  <p>Move mouse pointer over canvas.</p>
  <img src="img/flower01.jpg" id="flower" class="demo092" />
  <canvas id="mycanvas" width="750" height="375"></canvas>
  <p id="testmessage"></p>
  <script src="../source/scrawlCore.js"></script>
  <script id="myscript">
  var mycode = function() {
    'use strict'
    var testTicker = Date.now(),
      testTime = testTicker,
      testNow,
      testMessage = document.getElementById('testmessage');

    //define variables
    var myPad = scrawl.pad.mycanvas,
      here,
      gradient,
      myGloom,
      mySpotlight;

    //import images into scrawl library
    scrawl.getImagesByClass('demo092');

    //define designs (gradient)
    gradient = scrawl.newRadialGradient({
      name: 'spotlight',
      startRadius: 50,
      endRadius: 150,
      color: [{
        color: 'rgba(0,0,0,0)',
        stop: 0
      }, {
        color: 'rgba(0,0,0,0.8)',
        stop: 1
      }, ],
    });

    //define sprites
    scrawl.newPicture({
      source: 'flower',
      width: 750,
      height: 500,
    });

    myGloom = scrawl.newBlock({
      name: 'gloomy',
      fillStyle: 'rgba(0,0,0,0.8)',
      method: 'fill',
      width: 750,
      height: 375,
      order: 1,
    });

    mySpotlight = myGloom.clone({
      name: 'shiny',
      fillStyle: 'spotlight',
    });

    //animation object
    scrawl.newAnimation({
      fn: function() {
        here = myPad.getMouse();
        if (here.active) {
          gradient.set({
            startX: here.x,
            startY: here.y,
            endX: here.x,
            endY: here.y,
          });
          myGloom.set({
            visibility: false
          });
          mySpotlight.set({
            visibility: true
          });
        } else {
          myGloom.set({
            visibility: true
          });
          mySpotlight.set({
            visibility: false
          });
        }
        scrawl.render();

        testNow = Date.now();
        testTime = testNow - testTicker;
        testTicker = testNow;
        testMessage.innerHTML = 'Milliseconds per screen refresh: ' + parseInt(testTime) + '; fps: ' + parseInt(1000 / testTime);
      },
    });
  };

  scrawl.loadModules({
      path: '../source/js/',
      minified: false,
      modules: ['block', 'images', 'animation'],
      callback: function() {
        window.addEventListener('load', function() {
            scrawl.init();
            mycode();
          };
        },
      });
  </script>
</body>

</html>
