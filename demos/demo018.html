<!DOCTYPE html>
<html>

<head>
  <title>Demo 018</title>
  <link href="css/normalize.css" rel="stylesheet" />
  <link href="css/demo.css" rel="stylesheet" />
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
</head>

<body>
  <img id="peacock" src="img/carousel/peacock.png" class="demo018" />
  <div id="titleBlock">
    <h1><a href="index.html">Scrawl.js</a> - demonstration 018</h1>
    <h2>Determining the canvas color value at the mouse cursor</h2>
    <h3>Modules: images, animation</h3>
    <p id="message">Move mouse over image</p>
  </div>
  <canvas id="mycanvas" width="400" height="400"></canvas>
  <p id="testmessage"></p>
  <script src="../source/scrawlCore.js"></script>
  <script id="myscript">
  var mycode = function() {
    'use strict'
    var testTicker = Date.now(),
      testTime = testTicker,
      testNow,
      testMessage = document.getElementById('testmessage'),
      myMessage = document.getElementById('message');

    //define variables
    var here,
      myPad = scrawl.pad.mycanvas,
      myColor,
      titles = document.getElementById('titleBlock'),
      myBird;

    //import image into scrawl library
    scrawl.getImagesByClass('demo018');

    //define Picture sprite ...
    myBird = scrawl.newPicture({
      name: 'bird',
      source: 'peacock',
      startX: 200,
      startY: 200,
      width: 200,
      height: 200,
      handleX: 'center',
      handleY: 'center',
      copyX: 140,
      copyY: 80,
      copyWidth: 250,
      copyHeight: 250,
      roll: 30,
      scale: 1.4,
      flipReverse: true,
      imageDataChannel: 'color',
      // ... and get its image data
    }).getImageData();

    //display the canvas - only needs to be done once
    scrawl.render();

    //the animation object function keeps track of the mouse over the canvas
    //and retrieves the color at the mouse coordinate
    scrawl.newAnimation({
      fn: function() {
        myColor = 'transparent';
        here = myPad.getMouse();

        //here.active is set to TRUE when mouse cursor is over the canvas element
        if (here.active) {
          myColor = myBird.getImageDataValue(here) || 'transparent';
        }

        //update the DOM title block with the current color
        titles.style.backgroundColor = myColor;

        myMessage.innerHTML = (here.active) ? 'Color at mouse cursor point (x: ' + here.x + ', y: ' + here.y + ') is ' + myColor : 'Move mouse over image';
        testNow = Date.now();
        testTime = testNow - testTicker;
        testTicker = testNow;
        testMessage.innerHTML = 'Milliseconds per screen refresh: ' + parseInt(testTime) + '; fps: ' + parseInt(1000 / testTime);
      },
    });
  };

  scrawl.loadModules({
    path: '../source/',
    minified: false,
    modules: ['images', 'animation'],
    callback: function() {
      window.addEventListener('load', function() {
        scrawl.init();
        mycode();
      }, false);
    },
  });
  </script>
</body>

</html>
