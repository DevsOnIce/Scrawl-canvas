<!DOCTYPE html>
<html>

<head>
  <title>Demo 208</title>
  <link href="css/normalize.css" rel="stylesheet" />
  <link href="css/demo.css" rel="stylesheet" />
  <style>
    #mystack {
      border: solid 1px red;
    }
  </style>
</head>

<body>
  <h1><a href="index.html">Scrawl.js</a> - demonstration 208</h1>
  <h2>CSS 3d rotating cube in responsive Scrawl stack</h2>
  <h3>Modules: phrase, animation, stacks, images</h3>
  <div id="mystack" class="scrawlstack">
    <p id="instructions" style="border: 1px solid black; text-align: center; font-size: 200%">Move mouse over stack</p>
    <canvas id="top" width="200" height="200"></canvas>
    <canvas id="bottom" width="200" height="200"></canvas>
    <canvas id="left" width="200" height="200"></canvas>
    <canvas id="right" width="200" height="200"></canvas>
    <canvas id="front" width="200" height="200"></canvas>
    <canvas id="back" width="200" height="200"></canvas>
  </div>
  <img src="img/graphs/burglary-color.jpg" id="burglary" class="demo208" />
  <img src="img/graphs/damage-color.jpg" id="damage" class="demo208" />
  <img src="img/graphs/fraud-color.jpg" id="fraud" class="demo208" />
  <img src="img/graphs/robbery-color.jpg" id="robbery" class="demo208" />
  <img src="img/graphs/theft-color.jpg" id="theft" class="demo208" />
  <img src="img/graphs/violence-color.jpg" id="violence" class="demo208" />
  <script src="../source/scrawlCore.js"></script>
  <script id="myscript">
    var mycode = function() {
      'use strict'
      var sides = ['top', 'bottom', 'left', 'right', 'front', 'back'],
        pics = ['robbery', 'theft', 'violence', 'fraud', 'burglary', 'damage'],
        pads = {
          top: scrawl.pad.top,
          bottom: scrawl.pad.bottom,
          left: scrawl.pad.left,
          right: scrawl.pad.right,
          front: scrawl.pad.front,
          back: scrawl.pad.back,
        },
        cells = {
          top: scrawl.cell[pads.top.base],
          bottom: scrawl.cell[pads.bottom.base],
          left: scrawl.cell[pads.left.base],
          right: scrawl.cell[pads.right.base],
          front: scrawl.cell[pads.front.base],
          back: scrawl.cell[pads.back.base],
        },
        mystack = scrawl.stack.mystack,
        labels,
        instructions = scrawl.element.instructions,
        widthReduction = 35,
        heightReduction = 120,
        myWidth = window.innerWidth - widthReduction,
        myHeight = window.innerHeight - heightReduction,
        setSize,
        resize,
        cube = scrawl.makeQuaternion(),
        deltaCube = scrawl.makeQuaternion({
          pitch: 1,
          yaw: -0.8,
          roll: 0.3,
        }),
        here,
        words;
      scrawl.getImagesByClass('demo208');
      //initialize DOM 3d effects - stack
      myWidth = (myWidth > 100) ? myWidth : 100;
      myHeight = (myHeight > 100) ? myHeight : 100;
      mystack.set({
        width: myWidth,
        height: myHeight,
        perspectiveZ: 800,
        overflow: 'hidden',
      });
      instructions.set({
        startX: '50%',
        startY: '20%',
        handleX: 'center',
        handleY: 'center',
        width: instructions.width * 1.5,
        pointerEvents: 'none',
      });
      for (var i = 0, z = sides.length; i < z; i++) {
        pads[sides[i]].set({
          startX: 'center',
          startY: 'center',
          handleX: 'center',
          handleY: 'center',
          mouse: false,
          pointerEvents: 'none',
        });
      }
      pads.top.set({
        deltaPitch: 90,
        deltaTranslateY: -100
      });
      pads.bottom.set({
        deltaPitch: -90,
        deltaTranslateY: 100
      });
      pads.left.set({
        deltaYaw: -90,
        deltaTranslateX: -100
      });
      pads.right.set({
        deltaYaw: 90,
        deltaTranslateX: 100
      });
      pads.back.set({
        deltaYaw: -180,
        deltaTranslateZ: -100
      });
      pads.front.set({
        deltaYaw: 0,
        deltaTranslateZ: 100
      });
      words = scrawl.newGroup({
        name: 'words',
        visibility: false,
      });
      for (var i = 0, z = sides.length; i < z; i++) {
        scrawl.newPicture({
          name: pics[i],
          pivot: sides[i] + 'Text',
          handleX: 'center',
          handleY: 'center',
          width: 200,
          height: 200,
          source: pics[i],
          order: 0,
          group: pads[sides[i]].base,
        });
        scrawl.newPhrase({
          name: sides[i] + 'Text',
          startX: 100,
          startY: 100,
          handleX: 'center',
          handleY: 'center',
          font: '36pt Arial, sans-serif',
          text: sides[i],
          order: 1,
          group: pads[sides[i]].base,
        });
        words.sprites.push(sides[i] + 'Text');
      }
      setSize = function() {
        var widthRatio = (window.innerWidth - widthReduction) / myWidth,
          heightRatio = (window.innerHeight - heightReduction) / myHeight,
          ratio = (widthRatio < heightRatio) ? widthRatio : heightRatio;
        document.body.style.fontSize = parseInt(ratio * 100) + '%';
        mystack.scaleStack(ratio);
      };
      resize = function(e) {
        setSize();
      };
      window.addEventListener('resize', resize);
      scrawl.newAnimation({
        fn: function() {
          //rotate the cube
          cube.quaternionMultiply(deltaCube);
          scrawl.update3d({
            action: 'pads',
            quaternion: cube,
            distance: 100,
          });
          scrawl.renderElements();
          //animate the canvas sprites
          words.updateSpritesBy({
            roll: 0.5,
          });
          scrawl.render();
          //cube and mouse stuff
          here = mystack.getMouse();
          for (var i = 0, z = sides.length; i < z; i++) {
            if (here.active) {
              pads[sides[i]].set({
                pivot: 'mouse',
              });
            } else {
              pads[sides[i]].set({
                pivot: false,
                startX: 'center',
                startY: 'center',
                handleX: 'center',
                handleY: 'center',
              });
            }
          }
          scrawl.render();
          scrawl.renderElements();
        },
      });
    };
    scrawl.loadModules({
        path: '../source/js/',
        minified: false,
        modules: ['phrase', 'animation', 'stacks', 'images'],
        callback: function() {
          window.addEventListener('load', function() {
              scrawl.init();
              mycode();
            };
          },
        });
  </script>
</body>

</html>
